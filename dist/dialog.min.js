!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define("dialog",["jquery"],e):t.FlexUI=e(t.jQuery)}(this,function(t){"use strict";function e(t){return O.call(t)}function n(t){return"[object Function]"===e(t)}function o(t){return"[object String]"===e(t)}function i(t){return"[object Number]"===e(t)}function r(t){return!!n(t)&&P.test(n.toString())}function a(t,e,n,o){Array.isArray(n)||(n=!1);var i;for(var r in e)if(e.hasOwnProperty(r)){if(n&&(i=n.indexOf(r),o?i===-1:i!==-1))continue;"prototype"!==r&&(t[r]=e[r])}return t}function c(){}function s(t,e,n){var o=e.prototype;return L?L(t.prototype,o):S?t.prototype=S(o):(c.prototype=o,t.prototype=new c,c.prototype=null),n&&a(t.prototype,n),t.prototype.constructor=t,t}function l(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);default:return t.apply(e,n)}}function u(t,e){var n=V?V(t,null):t.currentStyle;return{getPropertyValue:function(t){if(n)return n.getPropertyValue?n.getPropertyValue(t):(t=t.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),n.getAttribute?n.getAttribute(t):n[t])}}}function f(t,e){return o(t)?e?t.replace(F,function(t,n){return e.hasOwnProperty(n)?e[n]:n}):t:""}function d(t){for(var e in t)if(t.hasOwnProperty(e)&&void 0!==W[e])return e}function v(t){return 1e3*Number(t.slice(0,-1))}function _(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return v(e)+v(t[n])}))}function p(t){return t?t.split(", "):[]}function h(t){var e,n,o,i=u(t),r=p(i.getPropertyValue(K+"-delay")),a=p(i.getPropertyValue(K+"-duration")),c=_(r,a),s=p(i.getPropertyValue(q+"-delay")),l=p(i.getPropertyValue(q+"-duration")),f=_(s,l);return o=Math.max(c,f),e=o>0?c>f?K:q:null,n=e?e===K?a.length:l.length:0,{effect:e,count:n,timeout:o}}function m(t,e){if(!q&&!K)return e();var n=t[0],o=h(n),i=o.effect;if(!i)return e();var r=0,a=o.count,c=o.timeout,s=i===K?$[K]:D[q],l=function(){t.off(s,u),e()},u=function(t){t.target===n&&++r>=a&&l()};setTimeout(function(){r<a&&l()},c+1),t.on(s,u)}function g(){}function y(t){return i(t)&&t>0&&t!==1/0&&(B=t),B}function b(t){return t?B++:B}function w(){var e=this;e.destroyed=!1,e.node=document.createElement("div"),e.__node=t(e.node).attr("tabindex","-1").on("focusin",function(){e!==w.active&&e.focus()})}function x(t){try{/^iframe$/i.test(t.nodeName)||t.focus()}catch(e){}}function k(){var t=this;w.call(t),t.__node.css({display:"none",position:"absolute",top:0,left:0})}function N(t,e){var n=this;if(!(n instanceof N))return new N(t,e);e=e||{};var i=e.id;if(i&&o(i)){var r=Y[i];if(r)return r.off(),r.__node.off(),r.__init(t,e);n.id=i,Y[i]=n}else n.id=i=String(vt++);k.call(n),n.__node.attr("aria-labelledby",f(_t,{id:i})).attr("aria-describedby",f(pt,{id:i})),n.__init(t,e)}function A(t,e,o){t.forEach(function(t){t.which===e&&n(t.action)&&t.action.call(o,t)})}function E(t,e,n){var o="";return e.forEach(function(e,i){o+=f(t,{className:f(e.className,{skin:n}),title:e.title||e.value||"",value:e.value||"",index:i})}),o}function T(t,e){var n=e.options;A(n.controls,t,e),A(n.actions,t,e)}t="default"in t?t["default"]:t;var z=Object.prototype,M=Array.prototype,C=Function.prototype,O=z.toString,j=C.toString,P="";P+=j.call(Function),P=P.replace(/([.*+?^=!:$(){}|[\]\/\\])/g,"\\$1"),P=P.replace(/Function|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),P="^"+P+"$",P=new RegExp(P);var H=t(window),I=t(document),L=Object.setPrototypeOf;r(L)||(L=!1);var S=Object.create;r(S)||(S=!1);var V=window.getComputedStyle,F=/{{([a-z]*)}}/gi,W=document.documentElement.style,D={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",KhtmlAnimation:"khtmlAnimationEnd"},$={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",KhtmlTransition:"khtmlTransitionEnd"},q=d(D),K=d($),U=M.slice;g.prototype={on:function(t,e,n){var o=this,i=o.__events||(o.__events={});return n=arguments.length<3?o:n,(i[t]||(i[t]=[])).push({fn:e,context:n}),o},once:function(t,e,n){function o(){i.off(t,o),l(e,this,arguments)}var i=this;return i.on(t,o,n)},emit:function(t){for(var e,n,o,i=this,r=U.call(arguments,1),a=i.__events||(i.__events={}),c=a[t]||[],s=0,u=c.length;s<u;s++)n=c[s],e=l(n.fn,n.context,r),o!==!1&&(o=e);return o},off:function(t,e,n){var o=this,i=o.__events||(o.__events={}),r=arguments.length;switch(r){case 0:o.__events={};break;case 1:delete i[t];break;default:if(e){var a=i[t];if(a){n=r<3?o:n,r=a.length;for(var c=0;c<r;c++)if(evts[c].fn===e&&evts[c].fn.context===n){a.splice(c,1);break}a.length||delete i[t]}}}return o}};var B=1024,Q={alloc:[],anchor:null,node:t('<div tabindex="0"></div>').css({position:"fixed",top:0,left:0,width:"100%",height:"100%",userSelect:"none"}),zIndex:function(t){t=Math.max(0,--t),Q.node.css("z-index",t)},attach:function(t){var e=t.node,n=t.className+"-backdrop";Q.node.addClass(n).insertBefore(e),Q.anchor=t},show:function(t){var e=Q.alloc,n=e.indexOf(t);n!==-1&&n===e.length-1||(Q.attach(t),e.push(t))},hide:function(t){Q.alloc=Q.alloc.filter(function(e){return t!==e});var e=Q.alloc.length;e?(t=Q.alloc[e-1],Q.zIndex(t.zIndex),Q.attach(t)):(Q.node.remove(),Q.anchor=null)}},R={count:0,node:t('<div tabindex="0"></div>').css({width:0,height:0,opacity:0}),inc:function(t){++R.count,R.node.insertAfter(t.node)},dec:function(){R.count=Math.max(0,--R.count),R.count||R.node.remove()}};w.active=null,I.on("focusin",function(t){t.preventDefault();var e=t.target;if(e===Q.node[0]||e===R.node[0]){var n=Q.anchor;n&&n.open&&x(n.__node.find("[autofocus]")[0]||n.node)}}),w.cleanActive=function(t){R.count&&w.active!==t||(w.active=null)},s(w,g,{node:null,destroyed:!0,open:!1,autofocus:!0,modal:!1,innerHTML:"",className:"ui-layer",constructor:w,focus:function(){var t=this;if(t.destroyed||!t.open)return t;var e=t.node,n=t.__node,o=w.active;if(o&&o!==t&&o.blur(!1),!e.contains(t.__getActive())){var i=n.find("[autofocus]")[0];!t.__autofocus&&i?t.__autofocus=!0:i=e,t.__focus(i)}if(w.active!==t){var r=t.zIndex=b(!0);t.modal&&t!==Q.anchor&&(Q.show(t),Q.zIndex(r)),n.css("zIndex",r),n.addClass(t.className+"-focus"),t.emit("focus"),w.active=t}return t},blur:function(){var t=this;if(t.destroyed||!t.open)return t;var e=arguments[0];return w.cleanActive(t),e!==!1&&t.__focus(t.__activeElement),t.__autofocus=!1,t.__node.removeClass(t.className+"-focus"),t.emit("blur"),t},__focus:function(t){this.autofocus&&x(t)},__getActive:function(){try{var t=document.activeElement,e=t.contentDocument,n=e&&e.activeElement||t;return n}catch(o){}}});var X=/\s+/;s(k,w,{returnValue:void 0,anchor:null,fixed:!1,align:"bottom left",className:"ui-dialog",constructor:k,__show:function(t){var e=this;if(e.destroyed)return e;var n=e.__node;return e.open=!0,e.anchor=t||null,e.__activeElement=e.__getActive(),e.__ready||(n.addClass(e.className).css("position",e.fixed?"fixed":"absolute"),n.appendTo(document.body),R.inc(e),e.__ready=!0),e.__innerHTML!==e.innerHTML&&(n.html(e.innerHTML),e.__innerHTML=e.innerHTML),e.modal&&(Q.show(e),n.addClass(e.className+"-modal")),n.attr("role",e.modal?"alertdialog":"dialog").removeClass(e.className+"-close").addClass(e.className+"-show").show(),e.reset(),e.emit("show"),e.focus(),Q.zIndex(e.zIndex),e},show:function(t){var e=this;if(e.modal){var n=e.__node;e.open&&Q.hide(e),n.removeClass(e.className+"-modal")}return e.modal=!1,e.__show(t)},showModal:function(t){var e=this;e.__node;return e.modal=!0,e.__show(t)},close:function(t){var e=this;if(e.destroyed||!e.open)return e;if(e.emit("beforeclose")===!1)return e;void 0!==t&&(e.returnValue=t);var n=(e.node,e.__node);return n.removeClass(e.className+"-show").addClass(e.className+"-close"),e.blur(),m(n,function(){n.hide(),e.modal&&Q.hide(e),e.open=!1,e.emit("close")}),e},remove:function(){var t=this;if(t.destroyed)return t;if(t.emit("beforeremove")===!1)return t;w.cleanActive(t),t.open&&t.modal&&Q.hide(t),R.dec(t),t.__node.off().remove(),t.destroyed=!0,t.emit("remove");for(var e in t)delete t[e];return t},reset:function(){var t=this;if(t.destroyed||!t.open)return t;var e=t.__align;e&&(t.__node.removeClass(e),t.__align=null);var n=t.anchor;return n?t.__follow(n):t.__center(),t.emit("reset"),t},__center:function(){var t=this,e=t.__node,n=t.fixed,o=H.width(),i=H.height(),r=n?0:I.scrollLeft(),a=n?0:I.scrollTop(),c=e.outerWidth(),s=e.outerHeight(),l=382*(i-s)/1e3+a,u=(o-c)/2+r;e.css({top:Math.max(parseFloat(l),a),left:Math.max(parseFloat(u),r)})},__follow:function(e){var n=this,o=n.__node;if(e=e.parentNode&&t(e),!e||!e.length)return n.__center();if(e){var i=e.offset();if(i.left*i.top<0)return n.__center()}var r=n.fixed,a=H.width(),c=H.height(),s=I.scrollLeft(),l=I.scrollTop(),u=o.outerWidth(),f=o.outerHeight(),d=e?e.outerWidth():0,v=e?e.outerHeight():0,i=n.__offset(e[0]),_=i.left,p=i.top,h=r?_-s:_,m=r?p-l:p,g=r?0:l,y=r?0:s,b=g+c-f,w=y+a-u,x={},k=n.align.split(X),N=n.className+"-",A={top:"bottom",bottom:"top",left:"right",right:"left"},E={top:"top",bottom:"top",left:"left",right:"left"},T=[{top:m-f,bottom:m+v,left:h-u,right:h+d},{top:m,bottom:m-f+v,left:h,right:h-u+d}],z={top:m+v/2-f/2,left:h+d/2-u/2},M={left:[y,w],top:[g,b]};k.forEach(function(t,e){T[e][t]>M[E[t]][1]&&(t=k[e]=A[t]),T[e][t]<M[E[t]][0]&&(k[e]=A[t])}),k[1]||(E[k[1]]="left"===E[k[0]]?"top":"left",T[1][k[1]]=z[E[k[1]]]),N+=k.join("-")+" "+n.className+"-follow",n.__align=N,o.addClass(N),x[E[k[0]]]=parseFloat(T[0][k[0]]),x[E[k[1]]]=parseFloat(T[1][k[1]]),o.css(x)},__offset:function(e){var n=e.parentNode,o=n?t(e).offset():{left:e.pageX,top:e.pageY};e=n?e:e.target;var i=e.ownerDocument,r=i.defaultView||i.parentWindow;if(r==window)return o;var a=r.frameElement;i=t(i);var c=i.scrollLeft(),s=i.scrollTop(),l=t(a).offset(),u=l.left,f=l.top;return{top:o.top+f-s,left:o.left+u-c}}});var Y={},G="control",J="action",Z="data-role",tt="data-action-id",et="{{skin}}-header",nt="{{skin}}-controls",ot="{{skin}}-actions",it='<div id="{{id}}" class="{{skin}}-title" title={{title}}>{{value}}</div>',rt='<div id="{{id}}" class="{{skin}}-content">{{content}}</div>',at='<div class="'+et+'">  {{title}}  <div class="'+nt+'">{{controls}}</div></div>{{content}}<div class="'+ot+'">{{actions}}</div>',ct='<a href="javascript:;" class="{{className}}" title="{{title}}" '+Z+'="'+G+'" '+tt+'="{{index}}">{{value}}</a>',st='<button type="button" class="{{className}}" title="{{title}}" '+Z+'="'+J+'" '+tt+'="{{index}}">{{value}}</button>',lt="> ."+et+" > ."+nt,ut="> ."+ot,ft=lt+" ["+Z+"], "+ut+" ["+Z+"]",dt={id:null,title:"",controls:[],actions:[],fixed:!1,keyboard:!0,skin:"ui-dialog",align:"bottom left"},vt=Date.now(),_t="dialog-title:{{id}}",pt="dialog-content:{{id}}";I.on("keyup",function(t){var e=w.active;if(e instanceof N&&e.options.keyboard){var n=t.which,o=t.target,i=e.__node,r=e.className,a=i.find(f(lt,{skin:r}))[0],c=i.find(f(ut,{skin:r}))[0];if(13===n&&(a&&a.contains(o)||c&&c.contains(o)))return t.preventDefault();T(n,e)}});var ht=k.prototype.remove;s(N,k,{__init:function(t,e){var n=this;return n.__initContent(t),n.__initOptions(e),n.__initEvents(),n.__render()},constructor:N,__initContent:function(t){var e=this;return e.content=o(t)?t:"",e},__initOptions:function(e,n){var i=this;return i.options=e=t.extend({},n||dt,e),e.title=e.title||dt.title,o(e.title)&&(e.title={title:e.title,value:e.title}),e.controls=Array.isArray(e.controls)?e.controls:dt.controls,e.actions=Array.isArray(e.actions)?e.actions:dt.actions,e.skin=e.skin&&o(e.skin)?e.skin:dt.skin,i.fixed=e.fixed,i.align=e.align,i.className=e.skin,i},__initEvents:function(){var e=this,o=e.options,i=f(ft,{skin:e.className});return e.__node.on("click",i,function(){var i,r=t(this),a=r.attr(Z),c=r.attr(tt);switch(a){case G:i=o.controls[c];break;case J:i=o.actions[c]}i&&n(i.action)&&i.action.call(e)}),H.on("resize",e.__resize=function(){e.reset()}),e},__render:function(){var t=this,e=t.id,n=t.className,o=t.content,i=t.options,r=i.title,a=E(ct,i.controls,n),c=E(st,i.actions,n);return t.innerHTML=f(at,{skin:n,title:f(it,{id:f(_t,{id:e}),skin:n,title:r.title||r.value||"",value:r.value||""}),controls:a,content:f(rt,{id:f(pt,{id:e}),skin:n,content:o}),actions:c}),t},set:function(t,e){var n=this;if(!t||!o(t)||!e)return n;switch(t){case"content":n.__initContent(e);break;case"options":n.__initOptions(e,n.options)}return n.__render()},remove:function(){var t=this;if(!t.destroyed){var e=t.id,n=t.__resize;ht.call(t),t.destroyed&&(H.off("resize",n),Y[e]&&delete Y[e])}return t}});var mt={dialog:N,zIndex:function(t){return arguments.length?y(t):b()}};return mt});
//# sourceMappingURL=dialog.js.map