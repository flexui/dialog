!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define("dialog",["jquery"],e):t.Dialog=e(t.jQuery)}(this,function(t){"use strict";function e(t){return E.call(t)}function n(t){return"[object Function]"===e(t)}function o(t){return"[object String]"===e(t)}function i(t){return"[object Number]"===e(t)}function r(t){return!!n(t)&&z.test(n.toString())}function a(t,e,n,o){Array.isArray(n)||(n=!1);var i;for(var r in e)if(e.hasOwnProperty(r)){if(n&&(i=n.indexOf(r),o?i===-1:i!==-1))continue;"prototype"!==r&&(t[r]=e[r])}return t}function s(){}function c(t,e,n){var o=e.prototype;return O?O(t.prototype,o):j?t.prototype=j(o):(s.prototype=o,t.prototype=new s,s.prototype=null),n&&a(t.prototype,n),t.prototype.constructor=t,t}function l(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);default:return t.apply(e,n)}}function u(t,e){var n=I?I(t,null):t.currentStyle;return{getPropertyValue:function(t){if(n)return n.getPropertyValue?n.getPropertyValue(t):(t=t.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),n.getAttribute?n.getAttribute(t):n[t])}}}function f(t,e){return o(t)?e?t.replace(P,function(t,n){return e.hasOwnProperty(n)?e[n]:n}):t:""}function d(){}function _(){var e=this;e.destroyed=!1,e.node=document.createElement("div"),e.__node=t(e.node).attr("tabindex","-1").on("focusin",function(){e.focus()})}function v(t){for(var e in t)if(t.hasOwnProperty(e)&&void 0!==V[e])return e}function m(t){return 1e3*Number(t.slice(0,-1))}function p(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return m(e)+m(t[n])}))}function h(t){return t?t.split(", "):[]}function g(t){var e,n,o,i=u(t),r=h(i.getPropertyValue($+"-delay")),a=h(i.getPropertyValue($+"-duration")),s=p(r,a),c=h(i.getPropertyValue(W+"-delay")),l=h(i.getPropertyValue(W+"-duration")),f=p(c,l);return o=Math.max(s,f),e=o>0?s>f?$:W:null,n=e?e===$?a.length:l.length:0,{effect:e,count:n,timeout:o}}function y(t,e){if(!W&&!$)return e();var n=t[0],o=g(n),i=o.effect;if(!i)return e();var r=0,a=o.count,s=o.timeout,c=i===$?F[$]:S[W],l=function(){t.off(c,u),e()},u=function(t){t.target===n&&++r>=a&&l()};setTimeout(function(){r<a&&l()},s+1),t.on(c,u)}function b(){var t=this;_.call(t),t.__node.css({display:"none",position:"absolute",outline:0,top:0,left:0})}function w(t,e){var n=this;b.call(n),e=e||{};var i=e.id;if(o(i)){var r=D[i];if(r)return r.off(),r.__initContent(t),r.__initOptions(e),r.__render();D[i]=n}n.__initContent(t),n.__initOptions(e),n.__initEvents(),n.__render()}function x(t,e){e.options.buttons.forEach(function(o){o.which===t&&n(o.action)&&o.action.call(e)}),27===t&&e.close()}t="default"in t?t["default"]:t;var N=Object.prototype,k=Array.prototype,A=Function.prototype,E=N.toString,T=A.toString,z="";z+=T.call(Function),z=z.replace(/([.*+?^=!:$(){}|[\]\/\\])/g,"\\$1"),z=z.replace(/Function|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),z="^"+z+"$",z=new RegExp(z);var C=t(window),M=t(document),O=Object.setPrototypeOf;r(O)||(O=!1);var j=Object.create;r(j)||(j=!1);var I=window.getComputedStyle,P=/{{([a-z]*)}}/gi,H=k.slice;d.prototype={on:function(t,e,n){var o=this,i=o.__events||(o.__events={});return n=arguments.length<3?o:n,(i[t]||(i[t]=[])).push({fn:e,context:n}),o},once:function(t,e,n){function o(){i.off(t,o),l(e,this,arguments)}var i=this;return i.on(t,o,n)},emit:function(t){for(var e,n,o,i=this,r=H.call(arguments,1),a=i.__events||(i.__events={}),s=a[t]||[],c=0,u=s.length;c<u;c++)n=s[c],e=l(n.fn,n.context,r),o!==!1&&(o=e);return o},off:function(t,e,n){var o=this,i=o.__events||(o.__events={}),r=arguments.length;switch(r){case 0:o.__events={};break;case 1:delete i[t];break;default:if(e){var a=i[t];if(a){n=r<3?o:n,r=a.length;for(var s=0;s<r;s++)if(evts[s].fn===e&&evts[s].fn.context===n){a.splice(s,1);break}a.length||delete i[t]}}}return o}};var L={alloc:[],node:t('<div tabindex="0"></div>').css({position:"fixed",top:0,left:0,width:"100%",height:"100%",userSelect:"none"}),shim:t('<div tabindex="0"></div>').css({width:0,height:0,opacity:0}),zIndex:function(t){t=Math.max(0,--t),L.node.css("z-index",t)},attach:function(t){var e=t.node,n=t.className+"-backdrop";L.node.addClass(n).insertBefore(e),L.shim.insertAfter(e)},show:function(t){var e=L.alloc,n=e.indexOf(t);n!==-1&&n===e.length-1||(L.attach(t),e.push(t))},hide:function(t){L.alloc=L.alloc.filter(function(e){return t!==e});var e=L.alloc.length;0===e?(L.node.remove(),L.shim.remove()):(t=L.alloc[e-1],L.zIndex(t.zIndex),L.attach(t))}};_.active=null,_.zIndex=1024,_.backdrop=L,_.cleanActive=function(t){_.active===t&&(_.active=null)},M.on("focusin",function(t){var e=_.active;if(e&&e.modal){var n=t.target,o=e.node;n===o||o.contains(n)||e.focus()}}),c(_,d,{node:null,destroyed:!0,open:!1,autofocus:!0,modal:!1,innerHTML:"",className:"ui-layer",constructor:_,focus:function(){var t=this;if(t.destroyed||!t.open)return t;var e=t.node,n=t.__node,o=_.active;if(o&&o!==t&&o.blur(!1),!e.contains(t.__getActive())){var i=n.find("[autofocus]")[0];!t.__autofocus&&i?t.__autofocus=!0:i=e,t.__focus(i),o=_.active}if(o!==t){var r=t.zIndex=_.zIndex++;t.modal&&(L.show(t),L.zIndex(r)),n.css("zIndex",r),n.addClass(t.className+"-focus"),t.emit("focus"),_.active=t}return t},blur:function(){var t=this;if(t.destroyed||!t.open)return t;var e=arguments[0];return t.__cleanActive(),e!==!1&&t.__focus(t.__activeElement),t.__autofocus=!1,t.__node.removeClass(t.className+"-focus"),t.emit("blur"),t},__focus:function(t){try{this.autofocus&&!/^iframe$/i.test(t.nodeName)&&t.focus()}catch(e){}},__getActive:function(){try{var t=document.activeElement,e=t.contentDocument,n=e&&e.activeElement||t;return n}catch(o){}},__cleanActive:function(){_.active===this&&(_.active=null)}});var V=document.documentElement.style,S={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",KhtmlAnimation:"khtmlAnimationEnd"},F={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",KhtmlTransition:"khtmlTransitionEnd"},W=v(S),$=v(F),q=/\s+/;c(b,_,{returnValue:void 0,anchor:null,fixed:!1,align:"bottom left",className:"ui-dialog",constructor:b,__show:function(t){var e=this;if(e.destroyed)return e;var n=e.__node;return e.open=!0,e.anchor=t||null,e.__activeElement=e.__getActive(),e.__ready||(n.addClass(e.className).css("position",e.fixed?"fixed":"absolute"),n.appendTo(document.body),e.__ready=!0),e.__innerHTML!==e.innerHTML&&(n.html(e.innerHTML),e.__innerHTML=e.innerHTML),e.modal&&(_.backdrop.show(e),n.addClass(e.className+"-modal")),n.attr("role",e.modal?"alertdialog":"dialog").removeClass(e.className+"-close").addClass(e.className+"-show").show(),e.reset(),e.emit("show"),e.focus(),e},show:function(t){var e=this;if(e.modal){var n=e.__node;e.open&&_.backdrop.hide(e),n.removeClass(e.className+"-modal")}return e.modal=!1,e.__show(t)},showModal:function(t){var e=this;e.__node;return e.modal=!0,e.__show(t)},close:function(t){var e=this;if(e.destroyed||!e.open)return e;if(e.emit("beforeclose")===!1)return e;void 0!==t&&(e.returnValue=t);var n=(e.node,e.__node);return n.removeClass(e.className+"-show").addClass(e.className+"-close"),e.blur(),y(n,function(){n.hide(),e.modal&&_.backdrop.hide(e),e.open=!1,e.emit("close")}),e},remove:function(){var t=this;if(t.destroyed)return t;if(t.emit("beforeremove")===!1)return t;t.__cleanActive(),t.open&&t.modal&&_.backdrop.hide(t),t.__node.off().remove(),t.destroyed=!0,t.emit("remove");for(var e in t)delete t[e];return t},reset:function(){var t=this;if(t.destroyed||!t.open)return t;var e=t.__align;e&&(t.__node.removeClass(e),t.__align=null);var n=t.anchor;return n?t.__follow(n):t.__center(),t.emit("reset"),t},__center:function(){var t=this,e=t.__node,n=t.fixed,o=C.width(),i=C.height(),r=n?0:M.scrollLeft(),a=n?0:M.scrollTop(),s=e.outerWidth(),c=e.outerHeight(),l=382*(i-c)/1e3+a,u=(o-s)/2+r;e.css({top:Math.max(parseFloat(l),a),left:Math.max(parseFloat(u),r)})},__follow:function(e){var n=this,o=n.__node;if(e=e.parentNode&&t(e),!e||!e.length)return n.__center();if(e){var i=e.offset();if(i.left*i.top<0)return n.__center()}var r=n.fixed,a=C.width(),s=C.height(),c=M.scrollLeft(),l=M.scrollTop(),u=o.outerWidth(),f=o.outerHeight(),d=e?e.outerWidth():0,_=e?e.outerHeight():0,i=n.__offset(e[0]),v=i.left,m=i.top,p=r?v-c:v,h=r?m-l:m,g=r?0:l,y=r?0:c,b=g+s-f,w=y+a-u,x={},N=n.align.split(q),k=n.className+"-",A={top:"bottom",bottom:"top",left:"right",right:"left"},E={top:"top",bottom:"top",left:"left",right:"left"},T=[{top:h-f,bottom:h+_,left:p-u,right:p+d},{top:h,bottom:h-f+_,left:p,right:p-u+d}],z={top:h+_/2-f/2,left:p+d/2-u/2},O={left:[y,w],top:[g,b]};N.forEach(function(t,e){T[e][t]>O[E[t]][1]&&(t=N[e]=A[t]),T[e][t]<O[E[t]][0]&&(N[e]=A[t])}),N[1]||(E[N[1]]="left"===E[N[0]]?"top":"left",T[1][N[1]]=z[E[N[1]]]),k+=N.join("-")+" "+n.className+"-follow",n.__align=k,o.addClass(k),x[E[N[0]]]=parseFloat(T[0][N[0]]),x[E[N[1]]]=parseFloat(T[1][N[1]]),o.css(x)},__offset:function(e){var n=e.parentNode,o=n?t(e).offset():{left:e.pageX,top:e.pageY};e=n?e:e.target;var i=e.ownerDocument,r=i.defaultView||i.parentWindow;if(r==window)return o;var a=r.frameElement;i=t(i);var s=i.scrollLeft(),c=i.scrollTop(),l=t(a).offset(),u=l.left,f=l.top;return{top:o.top+f-c,left:o.left+u-s}}});var D={},K="handle",B="action",Q='<div class="{{className}}-title">  <div class="{{className}}-caption" title="{{title}}">{{title}}</div>  <div class="{{className}}-handle">    <a href="javascript:;" title="关闭" role="'+K+'" data-action="close" class="{{className}}-handle-close">×</a>  </div></div><div class="{{className}}-content">{{content}}</div><div class="{{className}}-action">{{buttons}}</div>',R='<button class="{{className}}" type="button" role="'+B+'" title="{{label}}" data-action="{{index}}">{{label}}</button>',U="> .{{className}}-title > .{{className}}-handle",X="> .{{className}}-action",Y=U+" [role], "+X+" [role]",G={id:null,buttons:[],anchor:null,fixed:!1,keyboard:!0,title:"弹出消息",skin:"ui-dialog",align:"bottom left"};C.on("keyup",function(t){var e=_.active;if(e instanceof w&&e.options.keyboard){var n=t.which,o=t.target,i=f(X,{className:e.className}),r=e.__node.find(i)[0];13===n&&r&&r.contains(o)||x(n,e)}}),w.zIndex=function(t){return arguments.length&&i(t)&&t>0&&t!==1/0&&(_.zIndex=t),_.zIndex};var J=b.prototype.remove;return c(w,b,{constructor:w,__initContent:function(t){var e=this;return e.content=o(t)?t:"",e},__initOptions:function(e){var n=this;return n.options=e=t.extend({},G,e),e.title=o(e.title)?e.title:G.title,e.buttons=Array.isArray(e.buttons)?e.buttons:G.buttons,e.skin=e.skin&&o(e.skin)?e.skin:G.skin,n.anchor=e.anchor,n.fixed=e.fixed,n.align=e.align,n.className=e.skin,n},__initEvents:function(){var e=this,o=e.options,i=f(Y,{className:e.className});return e.__node.on("click",i,function(){var i=t(this),r=i.attr("role"),a=i.attr("data-action");switch(r){case K:"close"===a&&x(27,e);break;case B:var s=o.buttons?o.buttons[a]:null;s&&n(s.action)&&s.action.call(e)}}),C.on("resize",e.__resize=function(){e.reset()}),e},__render:function(){var t="",e=this,n=e.content,o=e.options;return o.buttons.forEach(function(e,n){t+=f(R,{className:e.className,label:e.label,index:n})}),e.innerHTML=f(Q,{className:e.className,title:o.title,content:n,buttons:t}),e},set:function(t,e){var n=this,o=!1;switch(t){case"content":var i=n.content;n.__initContent(e||i),i!==n.content&&(o=!0);break;case"options":e&&(o=!0,e.id=n.options.id,n.__initOptions(e))}return o?n.__render():n},remove:function(){var t=this;if(!t.destroyed){var e=t.options.id,n=t.__resize;J.call(t),t.destroyed&&(C.off("resize",n),o(e)&&delete D[e])}return t}}),w});
//# sourceMappingURL=dialog.js.map