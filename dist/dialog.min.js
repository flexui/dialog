!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define("dialog",["jquery"],e):t.FlexUI=e(t.jQuery)}(this,function(t){"use strict";function e(t){return M.call(t)}function n(t){return"[object Function]"===e(t)}function o(t){return"[object String]"===e(t)}function i(t){return"[object Number]"===e(t)}function r(t){return!!n(t)&&j.test(n.toString())}function a(t,e,n,o){Array.isArray(n)||(n=!1);var i;for(var r in e)if(e.hasOwnProperty(r)){if(n&&(i=n.indexOf(r),o?i===-1:i!==-1))continue;"prototype"!==r&&(t[r]=e[r])}return t}function s(){}function c(t,e,n){var o=e.prototype;return F?F(t.prototype,o):I?t.prototype=I(o):(s.prototype=o,t.prototype=new s,s.prototype=null),n&&a(t.prototype,n),t.prototype.constructor=t,t}function l(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);default:return t.apply(e,n)}}function u(t,e){var n=S?S(t,null):t.currentStyle;return{getPropertyValue:function(t){if(n)return n.getPropertyValue?n.getPropertyValue(t):(t=t.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),n.getAttribute?n.getAttribute(t):n[t])}}}function d(t,e){return o(t)?e?t.replace(H,function(t,n){return e.hasOwnProperty(n)?e[n]:n}):t:""}function f(t){var e=L.exec(t);return e?e[1]+(e[2]||"px"):t}function h(){}function v(t){return i(t)&&t>0&&t!==1/0&&($=t),$}function _(t){return t?$++:$}function p(){var e=this;e.destroyed=!1,e.node=document.createElement("div"),e.__node=t(e.node).attr("tabindex","0").on("focusin",function(){e!==p.active&&e.focus()})}function m(t){for(var e in t)if(t.hasOwnProperty(e)&&void 0!==U[e])return e}function g(t){return 1e3*Number(t.slice(0,-1))}function y(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return g(e)+g(t[n])}))}function b(t){return t?t.split(", "):[]}function w(t){var e,n,o,i=u(t),r=b(i.getPropertyValue(X+"-delay")),a=b(i.getPropertyValue(X+"-duration")),s=y(r,a),c=b(i.getPropertyValue(R+"-delay")),l=b(i.getPropertyValue(R+"-duration")),d=y(c,l);return o=Math.max(s,d),e=o>0?s>d?X:R:null,n=e?e===X?a.length:l.length:0,{effect:e,count:n,timeout:o}}function k(t,e){if(!R&&!X)return e();var n=t[0],o=w(n),i=o.effect;if(!i)return e();var r=0,a=o.count,s=o.timeout,c=i===X?Q[X]:B[R],l=function(){t.off(c,u),e()},u=function(t){t.target===n&&++r>=a&&l()};setTimeout(function(){r<a&&l()},s+1),t.on(c,u)}function x(){var t=this;p.call(t),t.__node.addClass(t.className).css({display:"none",position:"absolute",top:0,left:0})}function N(t,e){var n=this;if(!(n instanceof N))return new N(t,e);e=e||{};var i=e.id;if(i&&o(i)){var r=tt[i];if(r)return r.off(),r.__initContent(t),r.__initOptions(e),r.__render();n.id=i,tt[i]=n}else n.id=i=String(mt++);x.call(n),n.__node.attr("aria-labelledby",d(gt,{id:i})).attr("aria-describedby",d(yt,{id:i}));var a=e.skin;n.className=a&&o(a)?a:pt.skin,n.__initContent(t),n.__initOptions(e),n.__initEvents(),n.__render()}function A(t,e,n){var o="";return e.forEach(function(e,i){o+=d(t,{className:d(e.className,{skin:n}),title:e.title||e.value||"",value:e.value||"",index:i})}),o}function E(t,e,o){var i=e.which;t.forEach(function(t){t.which===i&&n(t.action)&&t.action.call(o,e,t)})}t="default"in t?t["default"]:t;var z=Object.prototype,T=Array.prototype,C=Function.prototype,M=z.toString,O=C.toString,j="";j+=O.call(Function),j=j.replace(/([.*+?^=!:$(){}|[\]\/\\])/g,"\\$1"),j=j.replace(/Function|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),j="^"+j+"$",j=new RegExp(j);var P=t(window),V=t(document),F=Object.setPrototypeOf;r(F)||(F=!1);var I=Object.create;r(I)||(I=!1);var S=window.getComputedStyle,H=/{{([a-z]*)}}/gi,L=/^([+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|))(.*)$/i,W=T.slice;h.prototype={on:function(t,e,n){var o=this,i=o.__events||(o.__events={});return n=arguments.length<3?o:n,(i[t]||(i[t]=[])).push({fn:e,context:n}),o},once:function(t,e,n){function o(){i.off(t,o),l(e,this,arguments)}var i=this;return i.on(t,o,n)},emit:function(t){for(var e,n,o,i=this,r=W.call(arguments,1),a=i.__events||(i.__events={}),s=a[t]||[],c=0,u=s.length;c<u;c++)n=s[c],e=l(n.fn,n.context,r),o!==!1&&(o=e);return o},off:function(t,e,n){var o=this,i=o.__events||(o.__events={}),r=arguments.length;switch(r){case 0:o.__events={};break;case 1:delete i[t];break;default:if(e){var a=i[t];if(a){n=r<3?o:n,r=a.length;for(var s=0;s<r;s++)if(evts[s].fn===e&&evts[s].fn.context===n){a.splice(s,1);break}a.length||delete i[t]}}}return o}};var $=1024,q={alloc:[],anchor:null,node:t('<div tabindex="0"></div>').css({position:"fixed",top:0,left:0,width:"100%",height:"100%"}),zIndex:function(t){t=Math.max(0,--t),q.node.css("z-index",t)},attach:function(t){var e=t.node,n=t.className+"-backdrop";q.node.addClass(n).insertBefore(e),q.anchor=t},show:function(t){var e=q.alloc,n=e.indexOf(t);n!==-1&&n===e.length-1||(q.attach(t),e.push(t))},hide:function(t){q.alloc=q.alloc.filter(function(e){return t!==e});var e=q.alloc.length;e?(t=q.alloc[e-1],q.zIndex(t.zIndex),q.attach(t)):(q.node.remove(),q.anchor=null)}},D={node:t('<div tabindex="0"></div>').css({width:0,height:0,opacity:0}),show:function(t){q.anchor&&D.node.insertAfter(t.node)},hide:function(){q.anchor||D.node.remove()}},K="-focus";p.active=null,V.on("focusin",function(t){var e=t.target,n=p.active,o=q.anchor;if(o)switch(e){case q.node[0]:n?n.focus():o.focus();break;case D.node[0]:o.focus()}else n&&e!==n.node&&!n.node.contains(e)&&n.blur()}),c(p,h,{node:null,destroyed:!0,open:!1,modal:!1,innerHTML:"",className:"ui-layer",constructor:p,focus:function(){var t=this;if(t.destroyed||!t.open)return t;var e=p.active;e&&e!==t&&e.blur();var n=t.node,o=t.__node,i=t.__getActive();if(n===i||n.contains(i)||t.__focus(o.find("[autofocus]")[0]||n),p.active!==t){var r=t.zIndex=_(!0);t.modal&&t!==q.anchor&&(t.__backdrop("show"),t.__backdrop("z-index",r)),o.css("zIndex",r),o.addClass(t.className+K),t.emit("focus"),p.active=t}return t},blur:function(){var t=this;return t.destroyed||!t.open?t:(t===p.active&&(p.active=null,t.__node.removeClass(t.className+K),t.emit("blur")),t)},__focus:function(t){try{/^iframe$/i.test(t.nodeName)||t.focus()}catch(e){}},__getActive:function(){try{var t=document.activeElement,e=t.contentDocument,n=e&&e.activeElement||t;return n}catch(o){}},__backdrop:function(t,e){var n=this;switch(t){case"show":case"hide":n.modal&&q[t](n),D[t](n);break;case"z-index":n.modal&&q.zIndex(e)}}});var U=document.documentElement.style,B={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",KhtmlAnimation:"khtmlAnimationEnd"},Q={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",KhtmlTransition:"khtmlTransitionEnd"},R=m(B),X=m(Q),Y=/\s+/,G="-show",J="-close",Z="-modal";c(x,p,{returnValue:void 0,anchor:null,fixed:!1,align:"bottom left",className:"ui-dialog",constructor:x,__html:function(t){var e=this,n=e.__node;e.__innerHTML!==t&&(n.html(t),e.__innerHTML=t)},__show:function(t){var e=this;if(e.destroyed)return e;e.open=!0,e.anchor=t||null;var n=e.__node;return n.attr("role",e.modal?"alertdialog":"dialog").css("position",e.fixed?"fixed":"absolute").removeClass(e.className+J).addClass(e.className+G),e.__html(e.innerHTML),n.appendTo(document.body),e.modal&&n.addClass(e.className+Z),e.__backdrop("show"),n.show(),e.reset(),e.emit("show"),e.focus(),e.__backdrop("z-index",e.zIndex),k(n,function(){e.emit("showed")}),e},show:function(t){var e=this;if(e.modal){var n=e.__node;e.open&&e.__backdrop("hide"),n.removeClass(e.className+Z)}return e.modal=!1,e.__show(t)},showModal:function(t){var e=this;e.__node;return e.modal=!0,e.__show(t)},close:function(t){var e=this;if(e.destroyed||!e.open)return e;if(e.emit("beforeclose")===!1)return e;void 0!==t&&(e.returnValue=t);var n=(e.node,e.__node);return n.removeClass(e.className+G).addClass(e.className+J),e.blur(),e.open=!1,e.emit("close"),k(n,function(){n.hide(),e.__backdrop("hide"),e.emit("closed")}),e},remove:function(){var t=this;if(t.destroyed)return t;if(t.emit("beforeremove")===!1)return t;t.blur(),t.__backdrop("hide"),t.__node.off().remove(),t.destroyed=!0,t.emit("remove");for(var e in t)delete t[e];return t},reset:function(){var t=this;if(t.destroyed||!t.open)return t;var e=t.__align;e&&(t.__node.removeClass(e),t.__align=null);var n=t.anchor;return n?t.__follow(n):t.__center(),t.emit("reset"),t},__center:function(){var t=this,e=t.__node,n=t.fixed,o=P.width(),i=P.height(),r=n?0:V.scrollLeft(),a=n?0:V.scrollTop(),s=e.outerWidth(),c=e.outerHeight(),l=382*(i-c)/1e3+a,u=(o-s)/2+r;e.css({top:Math.max(parseFloat(l),a),left:Math.max(parseFloat(u),r)})},__follow:function(e){var n=this,o=n.__node;if(e=e.parentNode&&t(e),!e||!e.length)return n.__center();if(e){var i=e.offset();if(i.left*i.top<0)return n.__center()}var r=n.fixed,a=P.width(),s=P.height(),c=V.scrollLeft(),l=V.scrollTop(),u=o.outerWidth(),d=o.outerHeight(),f=e?e.outerWidth():0,h=e?e.outerHeight():0,i=n.__offset(e[0]),v=i.left,_=i.top,p=r?v-c:v,m=r?_-l:_,g=r?0:l,y=r?0:c,b=g+s-d,w=y+a-u,k={},x=n.align.split(Y),N=n.className+"-",A={top:"bottom",bottom:"top",left:"right",right:"left"},E={top:"top",bottom:"top",left:"left",right:"left"},z=[{top:m-d,bottom:m+h,left:p-u,right:p+f},{top:m,bottom:m-d+h,left:p,right:p-u+f}],T={top:m+h/2-d/2,left:p+f/2-u/2},C={left:[y,w],top:[g,b]};x.forEach(function(t,e){z[e][t]>C[E[t]][1]&&(t=x[e]=A[t]),z[e][t]<C[E[t]][0]&&(x[e]=A[t])}),x[1]||(E[x[1]]="left"===E[x[0]]?"top":"left",z[1][x[1]]=T[E[x[1]]]),N+=x.join("-")+" "+n.className+"-follow",n.__align=N,o.addClass(N),k[E[x[0]]]=parseFloat(z[0][x[0]]),k[E[x[1]]]=parseFloat(z[1][x[1]]),o.css(k)},__offset:function(e){var n=e.parentNode,o=n?t(e).offset():{left:e.pageX,top:e.pageY};e=n?e:e.target;var i=e.ownerDocument,r=i.defaultView||i.parentWindow;if(r==window)return o;var a=r.frameElement;i=t(i);var s=i.scrollLeft(),c=i.scrollTop(),l=t(a).offset(),u=l.left,d=l.top;return{top:o.top+d-c,left:o.left+u-s}}});var tt={},et="control",nt="action",ot="data-role",it="data-action-id",rt="{{skin}}-header",at="{{skin}}-controls",st="{{skin}}-actions",ct='<div id="{{id}}" class="{{skin}}-title" title={{title}}>{{value}}</div>',lt='<div id="{{id}}" class="{{skin}}-content" style="width: {{width}}; height: {{height}};">{{content}}</div>',ut='<div class="'+rt+'">  {{title}}  <div class="'+at+'">{{controls}}</div></div>{{content}}<div class="'+st+'">{{actions}}</div>',dt='<a href="javascript:;" class="{{className}}" title="{{title}}" '+ot+'="'+et+'" '+it+'="{{index}}">{{value}}</a>',ft='<button type="button" class="{{className}}" title="{{title}}" '+ot+'="'+nt+'" '+it+'="{{index}}">{{value}}</button>',ht="> ."+rt+" > ."+at,vt="> ."+st,_t=ht+" ["+ot+"], "+vt+" ["+ot+"]",pt={id:null,title:{title:"",value:""},controls:[],actions:[],width:"auto",height:"auto",fixed:!1,keyboard:!0,skin:"ui-dialog",align:"bottom left"},mt=Date.now(),gt="aria-title:{{id}}",yt="aria-content:{{id}}";V.on("keydown",function(t){var e=p.active;if(e instanceof N&&!e.destroyed&&e.options.keyboard){var n=t.which,o=t.target,i=e.__node,r=e.className,a=i.find(d(ht,{skin:r}))[0],s=i.find(d(vt,{skin:r}))[0];if(13!==n||!a.contains(o)&&!s.contains(o)){var c=e.options;E(c.actions,t,e),E(c.controls,t,e)}}});var bt=x.prototype.remove;c(N,x,{constructor:N,__initContent:function(t){var e=this;return e.content=o(t)?t:"",e},__initOptions:function(e,n){var i=this;i.options=e=t.extend({},n||pt,e);var r=e.title,a=e.controls,s=e.actions,c=e.skin;return o(r)&&(r={title:r,value:r}),e.title=r||pt.title,e.width=f(e.width)||pt.which,e.height=f(e.height)||pt.height,e.controls=Array.isArray(a)?a:pt.controls,e.actions=Array.isArray(s)?s:pt.actions,e.skin=c&&o(c)?c:pt.skin,i},__initEvents:function(){var e=this,o=d(_t,{skin:e.className});return e.__node.on("click",o,function(o){var i,r=t(this),a=e.options,s=r.attr(ot),c=r.attr(it);switch(s){case et:i=a.controls[c];break;case nt:i=a.actions[c]}i&&n(i.action)&&i.action.call(e,o,i)}),P.on("resize",e.__resize=function(){e.reset()}),e},__render:function(){var t=this,e=t.id,n=t.className,o=t.content,i=t.options,r=i.title,a=A(dt,i.controls,n),s=A(ft,i.actions,n);return t.innerHTML=d(ut,{skin:n,title:d(ct,{id:d(gt,{id:e}),skin:n,title:r.title||r.value||"",value:r.value||""}),controls:a,content:d(lt,{id:d(yt,{id:e}),skin:n,width:i.width,height:i.height,content:o}),actions:s}),t},set:function(t,e){var n=this;if(!t||!o(t)||!e)return n;switch(t){case"content":n.__initContent(e);break;case"options":n.__initOptions(e,n.options)}return n.__render()},remove:function(){var t=this;if(!t.destroyed){var e=t.id,n=t.__resize;bt.call(t),t.destroyed&&(P.off("resize",n),tt[e]&&delete tt[e])}return t}});var wt={dialog:N,zIndex:function(t){return arguments.length?v(t):_()}};return wt});
//# sourceMappingURL=dialog.js.map